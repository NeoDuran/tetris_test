<style>
    #next-piece {
        border: 2px solid black;
        width: 120px;
        height: 120px;
        position: relative;
        margin-left: 20px;
        display: inline-block;
    }
</style>

<div style="display: flex; align-items: flex-start;">
    <div id="game-board"></div>
    <div>
        <div>다음 블록:</div>
        <div id="next-piece"></div>
        <div>점수: <span id="score">0</span></div>
    </div>
</div>

<script>
let nextPiece = null;
const moveSound = new Audio('https://assets.mixkit.co/active_storage/sfx/2571/2571-preview.mp3');
const clearSound = new Audio('https://assets.mixkit.co/active_storage/sfx/1667/1667-preview.mp3');

function drawBoard() {
    const nextBoard = document.getElementById('next-piece');
    nextBoard.innerHTML = '';
    if (nextPiece) {
        nextPiece.shape.forEach((row, y) => {
            row.forEach((value, x) => {
                if (value) {
                    const block = document.createElement('div');
                    block.className = 'block';
                    block.style.backgroundColor = 'purple';
                    block.style.left = x * BLOCK_SIZE + 'px';
                    block.style.top = y * BLOCK_SIZE + 'px';
                    nextBoard.appendChild(block);
                }
            });
        });
    }
}

function gameLoop() {
    if (!currentPiece) {
        if (!nextPiece) {
            nextPiece = createPiece();
        }
        currentPiece = nextPiece;
        nextPiece = createPiece();
        if (collision()) {
            alert('게임 오버! 점수: ' + score);
            board = Array(BOARD_HEIGHT).fill().map(() => Array(BOARD_WIDTH).fill(0));
            score = 0;
            nextPiece = null;
            return;
        }
    }
}

function mergePiece() {
    moveSound.currentTime = 0;
    moveSound.play();
}

function clearLines() {
    let linesCleared = 0;
    for (let y = BOARD_HEIGHT - 1; y >= 0; y--) {
        if (board[y].every(cell => cell)) {
            board.splice(y, 1);
            board.unshift(Array(BOARD_WIDTH).fill(0));
            linesCleared++;
            y++;
        }
    }
    if (linesCleared > 0) {
        clearSound.currentTime = 0;
        clearSound.play();
    }
    score += linesCleared * 100;
    document.getElementById('score').textContent = score;
}
</script>
